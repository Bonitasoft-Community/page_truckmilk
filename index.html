<!doctype html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <title>Truck Milk</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <!-- 
    <link rel="stylesheet" href="pageResource?page=custompage_truckmilk&location=css/animate.css" />
    <link rel="stylesheet" href="pageResource?page=custompage_truckmilk&location=css/bootstrap.min.css">
	<link rel="stylesheet" href="pageResource?page=custompage_truckmilk&location=css/main.css">
	<link rel="stylesheet" href="pageResource?page=custompage_truckmilk&location=css/style.css">
	<link rel="stylesheet" href="pageResource?page=custompage_truckmilk&location=css/customPage.css">
 
  -->
  <link rel="stylesheet" href="css/animate.css" />
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/style.css">

 <!--  file upload -->
  <link rel="stylesheet" href="css/dropbox.css">
 
 
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script type="text/javascript" src="https://www.google.com/uds/?file=visualization&amp;v=1&amp;hl=fr&amp;packages=corechart&amp;async=2"></script>
	<link type="text/css" href="https://www.google.com/uds/api/visualization/1.0/ff67c3772da186a412ae3231c32409e9/ui+fr.css" rel="stylesheet">
	<script type="text/javascript" src="https://www.google.com/uds/api/visualization/1.0/ff67c3772da186a412ae3231c32409e9/format+fr,default+fr,ui+fr,corechart+fr.I.js"></script>
	<link href="https://ajax.googleapis.com/ajax/static/modules/gviz/1.0/core/tooltip.css" rel="stylesheet" type="text/css">
		
		
	<!--  for the autocomplete -->
	<link rel="stylesheet" href="css/angular-material.min.css"> 

	
	 	
	
<style>
.Loading {
    display: inline-block;
    vertical-align: middle;
    background-position: center;
    background:no-repeat;
    background-image: url('data:image/gif;base64,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');
    width:20px;
    height:20px;
    margin-top:6px;
    margin-right:7px;
}
.AutocompleteDropDown {
	background-color: #fcf8e3;
	}
</style>
	 
</head>
<body ng-app="truckmilk">

<!--  Page Directory: @_PAGEDIRECTORY_@ -->


<div class="container-fluid" id="accordion">
<div class="row">

	<div class="component col-xs-12"  ng-controller="TruckMilkControler as ctrl">
		
		<center>
		<table><tr><td><h1>BSC - Truck Milk</h1></td><td rowspan="2"><img src="img/truckmilk.jpg" width="150" heigth="150" /></td></tr>
			<tr><td>
				<center>
					<div class="font-style: italic;">
					The <span style="color: red;font-weight: bold;">B</span>onita <span style="color: red;font-weight: bold;">SC</span>heduler&nbsp;
					</div>
					<a href="" ng-click="ctrl.showhistory( ! ctrl.isshowhistory )">V2.1</a>
				</center>
			</td></tr>
			<tr><td>
				<div id="showHistory" ng-if="ctrl.isshowhistory" style="border-width:2px;border-style:ridge;border-color:blue">
					1.0 2018 June<br>
					1.2 2018 Oct<br>
					2.0 2019 Jul<br>
					2.1 2019 Aug<br>		
					2.2 2019 Sept<br>
				</div>
			</td></tr>
		</table>
		</center>
	

	
		<ul class="nav nav-tabs"  ng-class="{'nav-stacked': vertical, 'nav-justified': justified}" style="border-bottom: 1px solid #c2c2c2;">
			<li ng-class="{active: active, disabled: false}" id="form-tab" heading="All" active="true" title="Jobs" select="ctrl.navbaractiv == 'Jobs'" class="{{ctrl.getNavClass('Jobs')}}" style="{{ctrl.getNavStyle('Jobs')}}">
				  <a ng-click="ctrl.navbaractiv = 'Jobs';"   class="ng-binding">Jobs</a>
			</li>
			<li ng-class="{active: active, disabled: false}" id="form-tab" heading="Groovy Code" active="true" title="Register a new job" select="ctrl.navbaractiv == 'Register'" class="{{ctrl.getNavClass('register')}}" style="{{ctrl.getNavStyle('Register')}}">
				  <a  ng-click="ctrl.navbaractiv='Register'"  class="ng-binding">Register a new Job</a>
			</li>
			<li ng-class="{active: active, disabled: false}" id="form-tab" heading="Timer" active="true" title="Maintenance" select="ctrl.navbaractiv == 'Maintenance'" class="{{ctrl.getNavClass('Maintenance')}}" style="{{ctrl.getNavStyle('Maintenance')}}">
				  <a  ng-click="ctrl.navbaractiv='Maintenance'" class="ng-binding">Maintenance</a>
			</li>

		</ul>
		
		<!--  ************************************************************  -->	
		<!--  Tab Jobs		 										-->
		<!--  ************************************************************  -->		
		<!-- Keep it ng-show, else the file drop will not work ! -->	
		<div class="col-lg-12" ng-show="ctrl.navbaractiv == 'Jobs'">
		<table><tr style="height:25px">
			<td>
				<input ng-model="ctrl.autorefresh" type="checkbox">Automatic refresh
			</td> 
			<td>
				&nbsp;&nbsp;&nbsp;
			</td><td>
				<div ng-if="ctrl.inprogress">
					<span class="Loading">.</span>Please wait, work in progress
				</div>
			</td>
			<td>
				<button ng-click="ctrl.refresh( false )" class="btn btn-info btn-xs" ng-disabled="ctrl.inprogress">Refresh</button>		
			</td>
		</tr>		
		</table>
			
		
			<div ng-if="ctrl.deploimentsuc.length >0 " class="alert alert-success">
				{{ctrl.deploimentsuc}}
			</div>
			<div ng-if="ctrl.deploimenterr.length >0 " class="alert alert-danger">
				{{ctrl.deploimenterr}}
			</div>
		
			<div class="alert alert-danger" role="alert" ng-if="ctrl.timererror.length > 0">{{ctrl.timererror}}</div>
			
			
			
			
			
	
				
						
						
			<table class="table table-striped table-hover table-condensed" style="border-collapse: collapse;">
					<tr>
						<th>Status</th>
						<th>Name</th>
						<th>Execution</th>
						<th>Report</th>
						<th>Frequency</th>
						<th>Next Execution</th>						
						<th>Controls</th>
						<th>Parameters</th>
						<th></th>
					</tr>
					
					<tbody ng-repeat="plugtour in ctrl.getListPlugTour() track by $index">
					<tr style="border-top: 1px solid black;"> 
						<td style="{{ctrl.getJobStyle(plugtour)}}">
							<div ng-if="plugtour.enable">
								<div ng-if="! (plugtour.trackExecution.inExecution || plugtour.trackExecution.imediateExecution)">
									<label class="label label-success btn-xs" >
										<span class="glyphicon glyphicon-ok-circle" > ACTIF
									</label>
								</div>
							</div>
							<div ng-if="! plugtour.enable">
								<label class="label label-default btn-xs" >
									<span class="glyphicon glyphicon-ban-circle"> INACTIF
								</label>								
							</div>
							
							</div>
								<div ng-if="plugtour.trackExecution.imediateExecution">
									<label class="label label-info btn-xs" >
										<span class="glyphicon glyphicon-ok-circle" > PENDING START
									</label>
								</div>
								<div ng-if="plugtour.trackExecution.inExecution && ! plugtour.askForStop">
									<label class="label label-primary btn-xs" >
										<span class="glyphicon glyphicon-ok-circle" > EXECUTING
									</label>
									<br>
									<div style=" font-size: 12px;">{{plugtour.trackExecution.inExecutionPercent}} % Finish at {{plugtour.trackExecution.inExecutionEndDateEstimatedst}} ({{plugtour.trackExecution.inExecutionEndTimeEstimatedinMSst}})</div> 
								</div>
								<div ng-if="plugtour.trackExecution.inExecution &&  plugtour.askForStop">
									<label class="label label-warning btn-xs" >
										<span class="glyphicon glyphicon-ok-circle" > PENDING STOP
									</label>
								</div>
							</div>
							
						</td><td style="{{ctrl.getJobStyle(plugtour)}}">							
							<span title="{{plugtour.id}}">{{plugtour.name}}</span>
							
						<!--  last execution information -->
						</td><td style="{{ctrl.getJobStyle(plugtour)}}">

							<div ng-if="plugtour.trackExecution.lastexecutionstatus == 'success' || plugtour.trackExecution.lastexecutionstatus=='successpartial'">
								<label class="label label-success btn-xs" >
									{{plugtour.trackExecution.lastexecutionstatus}}
								</label>
							</div>
							<div ng-if="plugtour.trackExecution.lastexecutionstatus == 'error' ">
								<label class="label label-danger btn-xs" >
									{{plugtour.trackExecution.lastexecutionstatus}}
								</label>
							</div>
							<div ng-if=" ! (plugtour.trackExecution.lastexecutionstatus == 'success' || plugtour.trackExecution.lastexecutionstatus=='successpartial' || plugtour.trackExecution.lastexecutionstatus == 'error')">
								<label class="label label-default btn-xs" >
									{{plugtour.trackExecution.lastexecutionstatus}}
								</label>
							</div>
							{{plugtour.trackExecution.lastexecutionst}}
							
						</td><td style="{{ctrl.getJobStyle(plugtour)}}">
							<a ng-click="ctrl.showreport( plugtour )">
									<span class="glyphicon glyphicon-file" title="Show the report" ></span>Reports
							</a>
						
						<!--  Next Execution : Cron + Next Exectution -->
						</td><td style="{{ctrl.getJobStyle(plugtour)}}">							
								<a  ng-click="ctrl.showSchedule( plugtour )">
									<span class="glyphicon glyphicon-time" title="Show the schedule"></span>
								</a>
								&nbsp;
								{{plugtour.cron}}
						</td><td style="{{ctrl.getJobStyle(plugtour)}}">
							{{plugtour.trackExecution.nextexecutionst}}
							
						
								
						
						<!--  controls -->
						</td><td style="{{ctrl.getJobStyle(plugtour)}}">							
							<table><tr><td style="vertical-align:top">						
								<div ng-if="! (plugtour.trackExecution.inExecution || plugtour.trackExecution.imediateExecution)">
									<button ng-click="ctrl.immediateJob( plugtour )" class="{{ctrl.getNowStyle( plugtour)}}" ng-disabled="ctrl.inprogress || plugtour.trackExecution.imediateExecution || plugtour.trackExecution.inExecution" title="{{ctrl.getNowTitle( plugtour)}}">
										Now
									</button>
								</div>
							</td><td ng-if="plugtour.trackExecution.inExecution || plugtour.trackExecution.imediateExecution" style="vertical-align:top">					
									<button ng-click="ctrl.abortJob( plugtour )" class="{{ctrl.getAbortStyle( plugtour)}}" title="{{ctrl.getAbortTitle( plugtour)}}">
										Abort
									</button>
							</td><td  ng-if="ctrl.showResetJobs" style="vertical-align:top;padding: 0px 25px;">
								
									<button ng-click="ctrl.resetJob( plugtour )" class="{{ctrl.getResetStyle( plugtour)}}" title="{{ctrl.getResetTitle( plugtour)}}">
										RESET
									</button>	
							</td></tr></table>
							
																
						<!-- ALL actions on the jobs --> 
						</td><td style="{{ctrl.getJobStyle(plugtour)}}">	
							
							<table><tr><td style="vertical-align:top;padding: 0px 10px;">													
								<a  ng-click="ctrl.showHostRestriction( plugtour )">
									<span class="glyphicon glyphicon-lock" title="Show the host restriction (which host the jobs must be executed)"></span>
								</a>
								&nbsp;
								{{plugtour.hostsrestriction}}
							</td><td style="vertical-align:top;padding: 0px 10px;">
								<div ng-if="plugtour.enable">							
									<button ng-click="ctrl.deactivateJob( plugtour )" class="btn btn-info btn-xs" ng-disabled="ctrl.inprogress">
										Deactivate
									</button>
								</div>
								<div ng-if="! plugtour.enable">							
									<button ng-click="ctrl.activateJob( plugtour )" class="btn btn-info btn-xs" ng-disabled="ctrl.inprogress">
										Activate
									</button>
								</div>
							</td><td style="vertical-align:top;padding: 0px 10px;">							
								<a  ng-click="ctrl.showparameters( plugtour )">
									<span class="glyphicon glyphicon-cog" title="Show parameters"></span>
								</a>
							</td></tr></table>
							
						</td><td style="{{ctrl.getJobStyle(plugtour)}}">										
							<button  ng-click="ctrl.removeJob( plugtour )" class="btn btn-danger btn-xs">
								<span class="glyphicon glyphicon-trash" title="Delete the tour"></span>&nbsp;Delete job 
							</button>
								
						</td>
					</tr>
					
					 <!-- 
					<tr><td colspan="5">
												
							inExecution={{plugtour.trackExecution.inExecution}}
							imediateExecution={{plugtour.trackExecution.imediateExecution}}
							AskForStop={{plugtour.askForStop}}<p>
							{{plugtour}}
						 
					</td></tr>
					 -->
					 
					<!--  SECOND LINE : parameters -->
					<tr ng-if="plugtour.show.schedule">
						<td ></td>
						<td colspan="6"">
							<div  style="box-shadow: 1px 1px 12px #555;">
								<div class="panel panel-info">
									<div class="panel-heading">
										<h5 class="panel-title">Schedule</h5>
										<div  style="position: relative; top: -25px; right: 0px; font-size: 18px; float:right"">
												<a  ng-click="ctrl.hideall( plugtour )" >
												<span class="glyphicon glyphicon-remove" ></span>
												</a>
										</div>
									</div>
									<div class="panel-body"></div>
										<table width="100%">
											<tr><td colspan="2" style="padding: 15px" >
												<input ng-model="plugtour.cron" maxlength="30" style="width:100%;padding: 0px 5px;margin: 8px 0;box-sizing: border-box;" />
												<div class="alert alert-default">
													Use a Cron definition string. Visit <a href="https://www.freeformatter.com/cron-expression-generator-quartz.html" target="blanck" style="color:black">Quartz Cron Editor</a><p>
													Format is "second minute hour day month dayOfWeek week"<br>
													<ul>
													<li> <b>*</b>  means "every" : every minute is 0 * * * * *
													<li> <b>/</b> give a frequency : every 10 minutes is 0 0/10 0 ? * * *
													<li> <b>,</b> to give multiple value : at 3 and 4 in the morning is 0 0 3,4 * * * *
													</ul>
												</div>
												<center>
													<button ng-click="ctrl.updateJob( plugtour)" class="btn btn-primary btn-xs" ng-disabled="ctrl.inprogress"> <span ng-if="ctrl.inprogress">{{ctrl.postParams.advPercent}} % </span> Update</button>												
												</center>
												</td>
											</tr>
										</table>
									</div> <!-- panel body -->
								</div> <!--  panel info -->
							</div> <!--  shadow -->
						</td>
						<td style="{{ctrl.getJobStyle(plugtour)}}"></td>
						
					</tr>
					
					<tr ng-if="plugtour.show.hostrestriction">
						<td style="{{ctrl.getJobStyle(plugtour)}}"></td>
						<td colspan="6" style="{{ctrl.getJobStyle(plugtour)}}">
							<div  style="box-shadow: 1px 1px 12px #555;">
								<div class="panel panel-info">
									<div class="panel-heading">
										<h5 class="panel-title">Hosts restriction</h5>
										<div  style="position: relative; top: -25px; right: 0px; font-size: 18px; float:right"">
												<a  ng-click="ctrl.hideall( plugtour )" >
												<span class="glyphicon glyphicon-remove" ></span>
												</a>
										</div>
									</div>
									<div class="panel-body">
										<table width="100%">
											<tr><td colspan="2" style="padding: 15px" >
												<input ng-model="plugtour.hostsrestriction" maxlength="30" style="width:100%;padding: 0px 5px;margin: 8px 0;box-sizing: border-box;" />
												<div class="alert alert-default">
													List of hosts where the job can run.<p>
													<b>In a cluster:</b><br>
													If the list is empty, then all hosts can run the job (even the job may be run multiple time). Else, only the hosts registered will execute the plugin. The value is a list of hostnames or IP Adress, separated by a ;<br>
													Example: 192.168.1.3;102.168.1.4<p>
			
													<b>Out a cluster:</b><br>
													you should leave this parameter empty.
			
												</div>
												<center>
													<button ng-click="ctrl.updateJob( plugtour)" class="btn btn-primary btn-xs" ng-disabled="ctrl.inprogress"> <span ng-if="ctrl.inprogress">{{ctrl.postParams.advPercent}} % </span> Update</button>												
												</center>
											</td>
											</tr>
										</table>
									</div> <!-- panel body -->
								</div> <!--  panel info -->
							</div> <!--  shadow -->
						</td>
						<td style="{{ctrl.getJobStyle(plugtour)}}"></td>
							
								

					</tr>
					<tr ng-if="plugtour.show.parameters">
						<td style="{{ctrl.getJobStyle(plugtour)}}"></td>
						<td colspan="6" style="{{ctrl.getJobStyle(plugtour)}}">
							<div  style="box-shadow: 1px 1px 12px #555;">
								<div class="panel panel-info">
									<div class="panel-heading">
										<h5 class="panel-title">Parameters</h5>
										<div  style="position: relative; top: -25px; right: 0px; font-size: 18px; float:right">
												<a  ng-click="ctrl.hideall( plugtour )" >
												<span class="glyphicon glyphicon-remove" ></span>
												</a>
										</div>
									</div>
									<div class="panel-body">												
										<input ng-model="plugtour.show.parametersexpl" type="checkbox" style="padding: 15px" />Detailled explanation
										
										<table width="100%">
											<tr style="vertical-align: top; border-top: 1px solid #ddd;">
												<td style="padding: 15px" >Name</td>
												<td><input ng-model="plugtour.newname" size="50"></input></td>
											</tr>
											
											<tr style="vertical-align: top; border-top: 1px solid #ddd;">
												<td style="padding: 15px" >Plug In</td>
												<td>{{plugtour.plugindisplayname}}</td>
											</tr>
							
							
											<tr style="vertical-align: top; border-top: 1px solid #ddd;">
												<td style="padding: 15px" >Identifiant</td>
												<td>{{plugtour.id}}</td>
											</tr>
											
											<tr style="vertical-align: top; border-top: 1px solid #ddd;">
												<td style="padding: 15px" >Description</td>
												<td ><textarea rows="4" cols="50" ng-model="plugtour.description"></textarea></td>
											</tr>
											<tr>
												<td style="padding: 15px" >Explanations</td>
												<td>
													<div ng-if="plugtour.show.parametersexpl" class="well">
														<div ng-bind-html="ctrl.getHtml(plugtour.explanation, 'plugTourExplanation' + plugtour.id)"></div>
													</div>
												</td>
											</tr>
											<!--  ----------------------------- Parameters Tour ---------------------------------- -->
											<!-- <td colspan="2">Parameters value = {{plugtour.parametersdef}}</td> -->
											<tr ng-repeat="parameterdef in plugtour.parametersdef">
												<td style="vertical-align: top; border-top: 1px solid #ddd;" title="{{parameterdef.name}}">{{parameterdef.label}}<br>
													<div ng-if="plugtour.show.parametersexpl" style="font-size: small; font-style: italic;font-weight: bold"><div ng-bind-html="ctrl.getHtml(parameterdef.explanation, 'parameterdef.explanation')"></div></div>
												</td>
												<td style="vertical-align: top; border-top: 1px solid #ddd;">
			
													<!--  PROCESSNAME, STRING, TEXT, LONG, OBJECT, ARRAY, BOOLEAN -->
													<!-- Type={{parameterdef.type}} / Value={{parameterdef.value}}
													parameterDef={{parameterdef}} -->
													
													<div ng-if="parameterdef.type ==='PROCESSNAME'">
														<span ng-if="parameterdef.inprogress"   class="Loading"></span>
														<md-autocomplete md-selected-item="parameterdef.value" 
															md-search-text="plugtour.parametersvalue[ parameterdef.name ]" 
															md-items="item in ctrl.query( 'queryprocess', plugtour.parametersvalue[ parameterdef.name ], parameterdef )" 
															md-item-text="item.display" md-delay="500"
														 	md-floating-label="Process name"
										    				md-clear-button="false" 
										    				style="width:300px" 
										    				md-menu-class="AutocompleteDropDown">
															  <span md-highlight-text="parameterdef.value">{{item.display}}</span>
														</md-autocomplete>
														
													</div>
																
													<div ng-if="parameterdef.type ==='USERNAME'">
														<md-autocomplete md-selected-item="parameterdef.value" 
															md-search-text="parameterdef.value_search" 
															md-items="item in ctrl.query( 'queryusers', plugtour.parametersvalue[ parameterdef.name ], parameterdef)" 
															md-item-text="item.display" md-delay="500"
														 	md-floating-label="Process name"
										    				md-clear-button="false" 
										    				style="width:300px" 
										    				md-menu-class="AutocompleteDropDown">
															  <span md-highlight-text="parameterdef.value">{{item.display}}</span>
														</md-autocomplete>
													
													</div>							
																			<!-- parameterdef.value -->
													<div ng-if="parameterdef.type ==='STRING'">
														<input ng-model="plugtour.parametersvalue[ parameterdef.name ]" maxlength="100" size="80" style="padding: 0px 5px;margin: 8px 0;box-sizing: border-box;" >
													</div>
													<div ng-if="parameterdef.type ==='TEXT'">
														<textarea ng-model="plugtour.parametersvalue[ parameterdef.name ]" rows="4" cols="50" style="padding: 0px 5px;margin: 8px 0;box-sizing: border-box;" ></textarea>
													</div>
													<div ng-if="parameterdef.type ==='LONG'">
														<input ng-model="plugtour.parametersvalue[ parameterdef.name ]" type="number" style="padding: 0px 5px;margin: 8px 0;box-sizing: border-box;" >
													</div>
													<div ng-if="parameterdef.type ==='ARRAY'">
														<table class="table table-stripped">
															<tr ng-repeat="paramarrayvalue in plugtour.parametersvalue[ parameterdef.name ] track by $index">
																<td>
																	<table> <!--  stay on the same line -->
																		<tr><td>
																		<input ng-model="plugtour.parametersvalue[ parameterdef.name ] [ $index ]" maxlength="30" style="padding: 0px 5px;margin: 8px 0;box-sizing: border-box;" >&nbsp;
																		</td><td>
																		<button ng-click="ctrl.removeInArray( plugtour.parametersvalue[ parameterdef.name ], paramarrayvalue )" class="btn btn-danger btn-xs" ng-disabled="ctrl.inprogress">remove</button>
																		</td></tr>
																	</table>
															</tr>
														</table>											 
														<button ng-click="ctrl.addInArray(plugtour.parametersvalue[ parameterdef.name ], '')" class="btn btn-success btn-xs" ng-disabled="ctrl.inprogress">Add</button>
													</div>
													
													<div ng-if="parameterdef.type ==='BOOLEAN'">
														<input ng-model="plugtour.parametersvalue[ parameterdef.name ]" type="checkbox" style="padding: 0px 5px;margin: 8px 0;box-sizing: border-box;">
													</div>
													
													
													<div ng-if="parameterdef.type ==='ARRAYMAP'">
														<table class="table table-striped table-sm table-warning">
															<tr>
																<th ng-repeat="header in parameterdef.arraymapDefinition">
																{{header.title}}
																<div ng-if="plugtour.show.parametersexpl">{{header.tips}}</div>
																</th>
																<th></th>
															</tr>
															
															 
															<tr ng-repeat="item in plugtour.parametersvalue[ parameterdef.name ] track by $index">
																<td ng-repeat="header in parameterdef.arraymapDefinition">
																	
																	<input ng-model="item[ header.name ]" maxlength="100" size="30" style="padding: 0px 5px;margin: 8px 0;box-sizing: border-box;" title="{{plugtour.show.parametersexpl}}">&nbsp;
																</td>
																<td>
																	<button ng-click="ctrl.removeInArray( plugtour.parametersvalue[ parameterdef.name ], item )" class="btn btn-danger btn-xs" ng-disabled="ctrl.inprogress">remove</button>
																</td>	
															</tr>
															
														</table>
														<button ng-click="ctrl.addInArray(plugtour.parametersvalue[ parameterdef.name ], {} )" class="btn btn-success btn-xs" ng-disabled="ctrl.inprogress">Add</button>
													</div>
													<div ng-if="parameterdef.type ==='FILEWRITE' || parameterdef.type ==='FILEREADWRITE' || parameterdef.type ==='FILEREAD'" >
														<div ng-if="plugtour.parametersvalue[ parameterdef.name ] === 'AVAILABLE'">
															
															<a class="btn btn-info" href="{{ctrl.downloadParameterFile(plugtour, parameterdef)}}" target="top">Download the Document</a>
															
														</div>
														<div ng-if="plugtour.parametersvalue[ parameterdef.name ] !== 'AVAILABLE'">
															No document
														</div>
													</div>
					
													<div ng-if="parameterdef.type ==='FILEREAD' || parameterdef.type ==='FILEREADWRITE'" >
														Upload the document via the Drag & Drop tool in the header.
														<!--  DFragAndDrop doesn't work here: it's inside a loop -->
													</div>
														
													<div ng-if=" parameterdef.type==='BUTTONARGS'"> 
													<!--  list of args		parametersdef = {{parameterdef}} -->
													
														<table>
															<tr>
															<td>
																<table class="table table-striped table-sm table-warning">
																<tr ng-repeat="item in parameterdef.args track by $index">
																	<td>
																		{{item.name}}
																	</td>
																	<td>
																		<input ng-model="plugtour.parametersvalue[ parameterdef.name ] [ item.name ]" maxlength="100" size="30" style="padding: 0px 5px;margin: 8px 0;box-sizing: border-box;" >&nbsp;
																	</td>
																</tr>												
																</table>
															</td>
															<td>
																{{parameterdef.buttonDescription}}<p>
																<button ng-click="ctrl.testbutton(parameterdef, plugtour)" class="btn btn-info btn-xs" ng-disabled="ctrl.inprogress">Execute {{parameterdef.name}}</button>
																
																
															</td>
															</tr>
														</table>
														<div ng-bind-html="ctrl.getHtml( parameterdef.listeventsexecution, 'listEventExecutionParamererDef')"></div>
										
													</div>																			
													 
												</td>
											</tr>
			
											<!-- <tr><td colspan="2">parameters=<div class="alert alert-primary">{{plugtour}}</div></td></tr>-->
											<!-- <tr><td  colspan="2">parametersvalue=<div class="alert alert-primary">{{plugtour.parametersvalue}}</div></td></tr> -->
											<!-- <tr><td colspan="2">parametersvalue_2=<div class="alert alert-danger">{{plugtour.parametersvalue2}}</div></td></tr> -->
											 
										</table>
										<center> 
											<button ng-click="ctrl.updateJob( plugtour)" class="btn btn-primary btn-xs" ng-disabled="ctrl.inprogress"> <span ng-if="ctrl.inprogress">Update {{ctrl.postParams.advPercent}} % </span> Update</button>
										</center>
										
										<div ng-bind-html="ctrl.getHtml( ctrl.listeventsexecution, 'listEventExecution')"></div>
									</div> <!-- panel body -->
								</div> <!--  panel info -->
							</div> <!--  shadow -->
						</td>
						
						<td style="{{ctrl.getJobStyle(plugtour)}}">
							
						</td>
							
					</tr>
					<tr ng-if="plugtour.show.report">
						<td style="{{ctrl.getJobStyle(plugtour)}}"></td>
						<td colspan="6" style="{{ctrl.getJobStyle(plugtour)}}">
							<div  style="box-shadow: 1px 1px 12px #555;">
								<div class="panel panel-info">
									<div class="panel-heading">
										<h5 class="panel-title">Report</h5>
										<div style="position: relative; top: -25px; right: 0px; font-size: 18px; float:right">
												<a  ng-click="ctrl.hideall( plugtour )" >
												<span class="glyphicon glyphicon-remove" ></span>
												</a>
										</div>
									</div>
									<div class="panel-body">	
									
										<table style="border-spacing: 10px 0px;border-collapse: separate;">
											<tr><td>Last execution</td><td><small>{{plugtour.trackExecution.lastexecutionst}}</small></td></tr>
											<tr><td>Next execution</td><td>{{plugtour.trackExecution.nextexecutionst}}</td></tr>
											<tr><td>Status</td><td>{{plugtour.trackExecution.lastexecutionstatus}}</td></tr>
											<tbody ng-repeat="parameterdef in plugtour.parametersdef"> 
											<tr ng-if="parameterdef.type ==='FILEWRITE' || parameterdef.type ==='FILEREADWRITE'">
												<td>{{parameterdef.name}}</td>
												<td><div ng-if="plugtour.parametersvalue[ parameterdef.name ] === 'AVAILABLE'">										
													<a class="btn btn-info" href="{{ctrl.downloadParameterFile(plugtour, parameterdef)}}" target="top">Download the Document</a>
													</div>
												</td>
											</tr>
											</tbody>	
										</table>
										
										
										
										<h5>History</h5>
										
										<table class="table table-striped table-hover table-condensed" >
											<tr>
												<th>Date</th>
												<th>Status</th>
												<th>Item processed</th>
												<th>Execution time (ms)</th>
												<th>Details</th>
												
											<tr ng-repeat="savedExec in plugtour.savedExecution" >
												<td>{{savedExec.execDateSt}}</td>
												<td>{{savedExec.status}}</td>
												<td style="text-align:right">{{savedExec.itemprocessed}}</td>
												<td style="text-align:right">{{savedExec.timeinms}}</td>
												<td><div ng-bind-html="ctrl.getHtml( savedExec.listevents, 'saveExecListEvents plugtour='+plugtour.id+'savedExec.execDateSt='+savedExec.execDateSt )"></div></td>
											</tr>
										</table>
									</div> <!-- panel body -->
								</div> <!--  panel info -->
							</div> <!--  shadow -->
						</td>
						<td style="{{ctrl.getJobStyle(plugtour)}}"></td>										

					</tr>
					<!-- 
					<tr><td colspan="7">
					 <div class="alert alert-success">{{plugtour.trackExecution}}</div> 
					 <div class="alert alert-primary">{{plugtour}}</div> 					 
					</td></tr>
					 -->
					<tr >
					<td colspan="5"> <div ng-bind-html="ctrl.getHtml(plugtour.listevents, 'plugtourlistevents')"></div>
					</td>
					</tr>
					
					</tbody>
				</table>
				
				
				<!-- ----------------------- Drop file ? -->
			<!-- Keep it ng-show, else the file drop will not work ! -->
			<div ng-show="ctrl.listParameterUpload.length > 0">
				<p>
				<table style="width:100%">
				<tr><td style="width:30%"></td>
					<td><div class="panel panel-info"  class="col-lg-4">
						<div class="panel-heading">
							Upload file
						</div>
						<div>
							<select ng-model="ctrl.parameterToUpload"  >
								<option ng-repeat="item in ctrl.listParameterUpload" value="{{item.internalid}}">{{item.displayname}}</option>
							</select>
							
							<div ng-show="ctrl.parameterToUpload.id !== null">
							<div ng-file-drop ng-model="files"
								class="drop-box ng-isolate-scope ng-valid ng-dirty"
								drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}"
								multiple="false" allow-dir="false">Drop your file here</div>
							<div ng-no-file-drop class="drop-box" style="display: none;">File Drop is not supported for this browser</div>
								
							{{ctrl.parameterToUploadStatus}}
							</div>
						</div>
					</div>
					</td></tr>
				</table>
			</div>
				
		</div>
		
		<!--  ************************************************************  -->	
		<!--  Tab Register		 										-->
		<!--  ************************************************************  -->			
		<div  class="col-lg-12" ng-if="ctrl.navbaractiv == 'Register'">
			Choose the plug in you want to use, then add it. You will configure it in the list after. 
			<table style="width:100%">
					<tr><td style="padding: 10px;">Plug in:</td><td>
						<select ng-model="ctrl.registerPlugin"  >
							<option ng-repeat="item in ctrl.getListPlugIn()" value="{{item.name}}">{{item.displayname}}</option>
						</select>
					</td></tr>
					<tr><td style="padding: 10px;">Name :</td><td>
						<input  type="text" ng-model="ctrl.registerName"	size="50">
					</td></tr>
					<tr><td colspan="2" style="padding: 10px;">
						<center>
							<button class="btn btn-info btn-xs" ng-click="ctrl.addJob(ctrl.registerPlugin, ctrl.registerName)" ng-disabled="ctrl.inprogress" >Register a new Job</button>
						</center>
					</td></tr>
			</table>
				<div ng-bind-html="ctrl.getHtml(ctrl.addlistevents, 'addListEvents' )"></div>
		
		</div> <!--  end listJobs -->

	
		<!--  ************************************************************  -->	
		<!--  Tab Maintenance		 										-->
		<!--  ************************************************************  -->			
		<div  class="col-lg-12" ng-if="ctrl.navbaractiv == 'Maintenance'">
	
		
			<div ng-if="ctrl.inprogress">
				<span class="Loading">.</span>Please wait, work in progress
			</div>
			<button ng-click="ctrl.refresh( true )" class="btn btn-info btn-xs" ng-disabled="ctrl.inprogress">Get Status</button>
		
	   		<!--  <div ng-bind-html="ctrl.getHtml(ctrl.listevents, 'mainlistevents' )"></div>  -->
	   		<p>
			
			<table style="width:100%;border-spacing: 10px 0px;border-collapse: separate; ">
			<tr>
			<td style="vertical-align:top">	
				<div class="panel panel-info"  class="col-lg-6" >
					<div class="panel-heading">
						Last execution status
					</div>
					<div>
						<table class="table table-striped table-hover table-condensed" >
							<tr ng-repeat="exec in ctrl.scheduler.lastheartbeat"><td>{{exec}}</td></tr>
						</table>
					</div>
				</div>
			
			</td><td style="vertical-align:top">			
				<div class="panel panel-info"  class="col-lg-6" >
					<div class="panel-heading">
						Information
					</div>
					<div style="border-spacing: 10px 0px;border-collapse: separate;" >
						<p>
						<div ng-if="! ctrl.scheduler.details">
							<div ng-bind-html="ctrl.getHtml(ctrl.scheduler.dashboardsyntheticlistevents, 'scheduler.dashboardsyntheticlistevents' )"></div>
						</div>
						<div ng-if="ctrl.scheduler.details">
							<div ng-bind-html="ctrl.getHtml(ctrl.scheduler.dashboardlistevents, 'scheduler.dashboardlistevents' )"></div>
						</div>
						<input type="checkbox" ng-model="ctrl.scheduler.details">Details</input>
					</div>
				</div>
			</td></tr>			
			</table>
			<p>
			
			<!--  <div class="alert alert-success">Scheduler={{ctrl.scheduler}}</div> -->
			<table style="width:100%;border-spacing: 10px 0px;border-collapse: separate; ">
			<tr>
			<td style="vertical-align:top">
				<div class="panel panel-primary"   >
					<div class="panel-heading">
						Jobs
					</div>
					<div>
						<input ng-model="ctrl.showResetJobs" type="checkbox">Show Reset Jobs
					</div>
				</div>
			</td>
			<td style="vertical-align:top">
			
				<div class="panel panel-primary"   >
					<div class="panel-heading">
						Scheduler
					</div>
					<div>
						<table>
							<tr><td style="padding: 10px;">Type: </td><td style="padding: 10px;">{{ctrl.scheduler.type}}</td></tr>
							<tr><td style="padding: 10px;">Info: </td><td style="padding: 10px;">{{ctrl.scheduler.info}}</td></tr>
						</table>
						<!--  status of last operation -->
						<div ng-bind-html="ctrl.getHtml(ctrl.scheduler.listevents, 'schedulerlistEvents' )"></div>
	
						<h3>
							<div ng-if="ctrl.scheduler.status=='STARTED'">
								<div class="label label-success " >
									<span class="glyphicon glyphicon-ok-circle" > ACTIF
								</div>
								<button ng-click="ctrl.schedulerOperation( false )" class="btn btn-primary btn-xs" ng-disabled="ctrl.inprogress">
									Stop
								</button>
							</div>
							<div ng-if="ctrl.scheduler.status=='SHUTDOWN'">
								<div class="label label-warning" >
									<span class="glyphicon glyphicon-ok-circle" > SHUTDOWN
								</div>
								<button ng-click="ctrl.schedulerOperation( true )" class="btn btn-primary btn-xs" ng-disabled="ctrl.inprogress">
									Start
								</button>
							</div>
							<div ng-if="ctrl.scheduler.status=='STOPPED'">					
								<div class="label label-default" >
									<span class="glyphicon glyphicon-ban-circle"> INACTIF
								</div>
								<button ng-click="ctrl.schedulerOperation( true )" class="btn btn-info btn-xs" ng-disabled="ctrl.inprogress">
									Start
								</button>
							</div>
							</h3>
						
						<table >
							<tr>
							<!--  Deploy does not work
								<td style="padding: 10px;">	
									<button ng-click="ctrl.schedulerMaintenance('deploy')" class="btn btn-warning btn-xs" ng-disabled="ctrl.inprogress">
										Deploy
									</button>
								</td>
								 -->
								 <td style="padding: 10px;">
									<button ng-click="ctrl.schedulerMaintenance('reset')" class="btn btn-warning btn-xs" ng-disabled="ctrl.inprogress">
										Reset
									</button>
								</td><td style="padding: 10px;">
									<select ng-model="ctrl.scheduler.selectscheduler"  >
										<option ng-repeat="item in ctrl.getListTypeScheduler()" value="{{item}}">{{item}}</option>
									</select>
									<button ng-click="ctrl.schedulerMaintenance('changescheduler')" class="btn btn-danger btn-xs" ng-disabled="ctrl.inprogress">
										Change the scheduler
									</button>
								</td>
							</tr>
						</table>
					</div>
				</div>
			</td>
			<td style="vertical-align:top">
				<div class="panel panel-primary"   >
					<div class="panel-heading">
						Command
					</div>
					<div>
						Attention: redeploy the command and all the dependencies containing in the Command. Note that dependencies are share with all Commands, and doing that, you may downgrade the dependencies version.
						<p>
						
						<input ng-model="ctrl.commandredeploy.redeploydependencies" type="checkbox">Redeploy dependencies
						<p>
			
						<button ng-click="ctrl.commandRedeploy()" class="btn btn-danger btn-xs" ng-disabled="ctrl.inprogress">Redeploy the command</button>
						<p>
						<div ng-if="ctrl.commandredeploy.deploimentsuc.length >0 " class="alert alert-success">
							{{ctrl.commandredeploy.deploimentsuc}}
						</div>
						<div ng-if="ctrl.commandredeploy.deploimenterr.length >0 " class="alert alert-danger">
							{{ctrl.commandredeploy.deploimenterr}}
						</div>

					</div>
				</div>
			</td>
			</tr>
			</table>
			
		</div> <!--  end maintenance -->

		<!-- Register a new plug in 
		<div class="col-lg-12">	
			<legend class="text-primary"><span class="glyphicon glyphicon-th"></span>Plug In</legend>	
			<div ng-if="ctrl.inprogress">
				<span class="Loading">.</span>Please wait, work in progress
			</div>
					
			<button class="btn btn-info" ng-disabled="ctrl.inprogress">Register a new PlugIn</button>
		</div>
		 -->
	</div> <!-- end class component-->
</div>
</div>



<!-- Third party dependencies -->
<script src="3rd-party/jquery.min.js"></script>
<script src="3rd-party/angular_155/angular.min.js"></script>
	
	<!-- <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script> 
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script> -->
		<!--  Material -->  

<script src="3rd-party/angular_155/angular-animate.min.js"></script>  
<script src="3rd-party/angular_155/angular-aria.min.js"></script>  
<script src="3rd-party/angular_155/angular-messages.min.js"></script> 
<script src="3rd-party/angular-material.min.js"></script>  

<script src="3rd-party/angular-resource.min.js"></script>
<script src="3rd-party/angular-cookies.min.js"></script>

<script src="3rd-party/bootstrap/js/bootstrap.min.js"></script>
<script src="3rd-party/angular-bootstrap-tpls.min.js"></script>

<!--  to allow the drop box -->
<script src="3rd-party/angular-file-upload.js"></script>  
<script	src="3rd-party/angular-file-upload-shim.min.js"></script>
<script	src="3rd-party/angular-file-upload.min.js"></script>

	 
<script src="3rd-party/ng-google-chart.js"></script> 

<script src="3rd-party/angular-sanitize.min.js"></script>


<!-- Application dependencies -->
<script src="pageResource?page=custompage_truckmilk&location=truckmilkmonitor.js&v=@_CURRENTTIMEMILIS_@"></script>
<!-- <script src="truckmilkmonitor.js?v=@_CURRENTTIMEMILIS_@"></script> -->

</body>
</html>		